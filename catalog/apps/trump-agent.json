{"script_excerpt":"const BUBBLE_TIME = 5\nconst EMOTE_TIME = 2\nconst LOOK_TIME = 5\n\nconst UP = new Vector3(0, 1, 0)\n\nconst v1 = new Vector3()\nconst v2 = new Vector3()\nconst v3 = new Vector3()\nconst q1 = new Quaternion()\nconst q2 = new Quaternion()\nconst m1 = new Matrix4()\n\nconst vrm = app.get('avatar')\n\n// SERVER\n\nif (world.isServer) {\n  // send initial state\n  const state = {\n    ready: true,\n  }\n  app.state = state\n  app.send('state', state)\n  // spawn controller\n  const ctrl = app.create('controller')\n  ctrl.position.copy(app.position)\n  world.add(ctrl)\n  ctrl.quaternion.copy(app.quaternion)\n  ctrl.add(vrm)\n  // read emotes\n  const emoteUrls = {}\n  if (config.emote1Name && config.emote1?.url) {\n    emoteUrls[config.emote1Name] = config.emote1.url\n  }\n  if (config.emote2Name && config.emote2?.url) {\n    emoteUrls[config.emote2Name] = config.emote2.url\n  }\n  if (config.emote3Name && config.emote3?.url) {\n    emoteUrls[config.emote3Name] = config.emote3.url\n  }\n  if (config.emote4Name && config.emote4?.url) {\n    emoteUrls[config.emote4Name] = config.emote4.url\n  }\n  // observe environment\n  let changed = true\n  let notifying = false\n  const info = {\n    world: {\n      id: null, // todo\n      name: null, // todo\n      url: null, // todo\n      context: config.context || 'You are in a virtual world powered by Hyperfy',\n    },\n    you: {\n      id: app.instanceId,\n      name: config.name,\n    },\n    emotes: Object.keys(emoteUrls),\n    triggers: [],\n    events: [],\n  }\n  world.on('enter', player => {\n    info.events.push({\n      type: 'player-enter',\n      playerId: player.entityId,\n    })\n    changed = true\n  })\n  world.on('leave', player => {\n    info.events.push({\n      type: 'player-leave',\n      playerId: player.entityId,\n    })\n    changed = true\n  })\n  world.on('chat', msg => {\n    if (msg.fromId === app.instanceId) return\n    info.events.push({\n      type: 'chat',\n      ...msg,\n    })\n    if (info.events.length > 16) {\n      info.events.shift()\n    }\n    changed = true\n  })\n  // DEB","script_path":"assets/2998e0a3c56caac66773362f073297e248fd4b0086083c7d17298157e8eaaf3c.js","source_files":[{"path":"assets/2998e0a3c56caac66773362f073297e248fd4b0086083c7d17298157e8eaaf3c.js","size_bytes":6865},{"path":"assets/a49fd36d62e15879a1a0aabc265904b68bfce32201f3a1d3098656e9c99daa0e.glb","size_bytes":119836},{"path":"assets/e9bde28f0150f41f859af8ff09693f9b979a79718306554dc54df6aaada5b396.vrm","size_bytes":15090720},{"path":"blueprint.json","size_bytes":1335}],"props":{"name":"Trump","context":"You are standing in a large open grassy field in the middle of the day with a nice blue sky. There is almost nothing else around except the whitehouse which is behind you.\n","emote0":{"name":"idle-happy-2.glb","url":"asset://a49fd36d62e15879a1a0aabc265904b68bfce32201f3a1d3098656e9c99daa0e.glb"},"emote":"4","emote1Name":"wave","emote1":{"name":"wave.glb","url":"asset://2e7dbb54117a5dc83362ae7df4e2909607a62cd3abddd8abb9c8d873c5941a4b.glb"},"emote2Name":"think","emote2":{"name":"thinking.glb","url":"asset://f26ed53da54504fd2fc0b49871feb0db4714b0bed60dd69d5514a4ee75d94fcf.glb"},"emote3Name":"cheer","emote3":{"name":"cheer.glb","url":"asset://930040910cff7d172218a6251cb091f5be62c42b0b4c3cf9f051a1793101ce6f.glb"},"emote4":{"name":"talking.glb","url":"asset://41e54bd466c366918d850312f8be6a9b27fb2683a661fa9e201387612cab8f22.glb"},"emote4Name":"explain","url":""},"asset_files":["2998e0a3c56caac66773362f073297e248fd4b0086083c7d17298157e8eaaf3c.js","2e7dbb54117a5dc83362ae7df4e2909607a62cd3abddd8abb9c8d873c5941a4b.glb","41e54bd466c366918d850312f8be6a9b27fb2683a661fa9e201387612cab8f22.glb","930040910cff7d172218a6251cb091f5be62c42b0b4c3cf9f051a1793101ce6f.glb","a49fd36d62e15879a1a0aabc265904b68bfce32201f3a1d3098656e9c99daa0e.glb","e9bde28f0150f41f859af8ff09693f9b979a79718306554dc54df6aaada5b396.vrm","f26ed53da54504fd2fc0b49871feb0db4714b0bed60dd69d5514a4ee75d94fcf.glb"],"blueprint_path":"blueprint.json"}