{"script_excerpt":"export default function main(world, app, fetch, props, setTimeout) {\napp.configure([\n  {\n    key: 'walk',\n    type: 'file',\n    kind: 'emote',\n    label: 'Walk',\n  },\n  {\n    key: 'idle',\n    type: 'file',\n    kind: 'emote',\n    label: 'Idle',\n  },\n  {\n    key: 'talk',\n    type: 'file',\n    kind: 'emote',\n    label: 'Talk',\n  }\n])\n\nconst v1 = new Vector3()\nconst q1 = new Quaternion()\nconst FORWARD = new Vector3(0, 0, -1)\n\n// Create the controller\nconst ctrl = app.create('controller', {\n  position: app.position.toArray(),\n  radius: 0.3,\n  height: 1,\n})\nworld.add(ctrl)\n\n// Set up the avatar\nconst src = props.avatar?.url\nconst avatar = app.get('avatar')\navatar.position.set(0, 0, 0)\navatar.quaternion.set(0, 0, 0, 1)\nctrl.add(avatar)\navatar.emote = props.walk?.url // Start with walking\n\n// Movement variables\nconst dir = new Vector3(0.7, 0, 1).normalize()\nconst move = new Vector3()\nconst gravity = 8\nconst speed = 1.7\n\n// Direction change variables\nlet frameCounter = 0\nlet nextDirectionChange = 180 // Starting interval (~3 seconds at 60 FPS)\nconst minTurnInterval = 120 // ~2 seconds\nconst maxTurnInterval = 300 // ~5 seconds\nlet directionIndex = 0\nconst directionAngles = [0, Math.PI / 4, Math.PI / 2, 3 * Math.PI / 4, Math.PI, 5 * Math.PI / 4, 3 * Math.PI / 2, 7 * Math.PI / 4]\n\n// State variables\nlet state = 'walking' // 'walking', 'idle', or 'talking'\nlet stateCounter = 0\nconst idleDuration = 450 // ~1 second\nconst talkDuration = 300 // ~2 seconds\n\n// Pseudo-random sequence for variation\nlet seed = 12345\nfunction pseudoRandom() {\n  seed = (seed * 1103515245 + 12345) & 0x7fffffff\n  return (seed / 0x7fffffff) // Normalize to 0-1\n}\n\n// Function to set direction based on pre-defined angles\nfunction updateDirection() {\n  const theta = directionAngles[directionIndex]\n  dir.set(Math.cos(theta), 0, Math.sin(theta)).normalize()\n  directionIndex = (directionIndex + 1) % directionAngles.length\n  nextDirectionChange = minTurnInterval + Math.floor(pseudoRandom() * (maxTurnInterval - min","script_path":"index.js","source_files":[{"path":"NPC_Prisoner.json","size_bytes":688},{"path":"assets/avatar.vrm","size_bytes":2324724},{"path":"assets/emote.glb","size_bytes":58476},{"path":"assets/idle.glb","size_bytes":511580},{"path":"assets/npc_prisoner.vrm","size_bytes":1656952},{"path":"assets/talk.glb","size_bytes":169528},{"path":"assets/walk.glb","size_bytes":123908},{"path":"index.js","size_bytes":3929}],"props":{"emote":{"type":"emote","url":"assets/emote.glb"},"avatar":{"type":"avatar","url":"assets/avatar.vrm"},"walk":{"type":"emote","url":"assets/walk.glb"},"idle":{"type":"emote","url":"assets/idle.glb"},"talk":{"type":"emote","url":"assets/talk.glb"}},"asset_files":["avatar.vrm","emote.glb","idle.glb","npc_prisoner.vrm","talk.glb","walk.glb"],"blueprint_path":"NPC_Prisoner.json"}