{"script_excerpt":"export default function main(world, app, fetch, props, setTimeout) {\napp.configure([\n  {\n    key: \"walk\",\n    type: \"file\",\n    kind: \"emote\",\n    label: \"Walk\",\n  },\n  {\n    key: \"run\",\n    type: \"file\",\n    kind: \"emote\",\n    label: \"Run\",\n  },\n  {\n    key: \"idle\",\n    type: \"file\",\n    kind: \"emote\",\n    label: \"Idle\",\n  },\n  {\n    key: \"animButton\",\n    label: \"attack\",\n    type: \"button\",\n    onClick: () => {\n      app.send(\"button_attack\");\n    },\n  },\n]);\n\n\nconsole.log(`app: ${app.instanceId} INIT`);\nconst avatar = app.get(\"avatar\");\n\nconst body = app.create('rigidbody', { type: 'kinematic', tag: 'mob:1' })\n// const overlapLayerMask = world.createLayerMask('environment')\nconst collider = app.create('collider',\n  {\n    type: 'box', \n    size: [0.3, 1.6, 0.3], \n    trigger: true,\n    layer: 'environment'\n  })\nbody.onTriggerEnter = (foo) => {\n  console.log(foo)\n}\nbody.add(collider)\napp.add(body)\n\n// Constants for hit detection\nconst HIT_DISTANCE = 1.2; // Distance in front of NPC for hit detection\nconst HIT_HEIGHT_OFFSET = 1.0; // Height offset for hit detection (target player torso)\n\n// Vector and math utilities for hit calculation\nconst forward = new Vector3(0, 0, -1);\nconst npcPosition = new Vector3();\nconst npcDirection = new Vector3();\nconst hitPosition = new Vector3();\nconst npcQuaternion = new Quaternion();\nconst hitPositionArray = [];\n\nif (world.isServer) {\n  // Store attack animations with their individual cooldowns\n  const attackAnimations = [];\n  let defaultCooldown = 2.5; // Default cooldown in seconds\n  let canAttack = true; // Track if NPC can attack\n\n  // Listen for attack animations from the sword\n  world.on(`npc:${app.instanceId}:receiveAttackAnimations`, (data) => {\n    console.log(`NPC ${app.instanceId} received attack animations:`, data);\n    if (data.attacks && data.attacks.length > 0) {\n      attackAnimations.length = 0; // Clear existing animations\n      data.attacks.forEach((anim) => attackAnimations.push(anim));\n\n      // Store default c","script_path":"index.js","source_files":[{"path":"NPC.json","size_bytes":1171},{"path":"assets/avatar.vrm","size_bytes":2324724},{"path":"assets/emote.glb","size_bytes":58476},{"path":"assets/fireAudio.mp3","size_bytes":26582},{"path":"assets/idle.glb","size_bytes":88600},{"path":"assets/npc.vrm","size_bytes":4817240},{"path":"assets/raptorAudio.mp3","size_bytes":26582},{"path":"assets/run.glb","size_bytes":92192},{"path":"assets/talk.glb","size_bytes":169528},{"path":"assets/walk.glb","size_bytes":123908},{"path":"index.js","size_bytes":6699}],"props":{"emote":{"type":"emote","url":"assets/emote.glb"},"avatar":{"type":"avatar","url":"assets/avatar.vrm"},"walk":{"type":"emote","url":"assets/walk.glb"},"idle":{"type":"emote","url":"assets/idle.glb"},"talk":{"type":"emote","url":"assets/talk.glb"},"run":{"type":"emote","url":"assets/run.glb"},"refDistance":5,"maxDistance":15,"rolloffFactor":5,"distanceModel":"inverse","fireAudio":{"type":"audio","url":"assets/fireAudio.mp3"},"playbackRate":1,"pauseDuration":2,"raptorAudio":{"type":"audio","url":"assets/raptorAudio.mp3"},"detectionRange":15,"fovAngle":120,"chasePlayer":true,"followDistance":3,"memoryDuration":5},"asset_files":["avatar.vrm","emote.glb","fireAudio.mp3","idle.glb","npc.vrm","raptorAudio.mp3","run.glb","talk.glb","walk.glb"],"blueprint_path":"NPC.json"}